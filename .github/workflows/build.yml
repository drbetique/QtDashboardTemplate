name: Build Qt Project

on: [push, pull_request]

jobs:
  build:
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v4

    - name: Set up Qt 6 from pre-installed version
      shell: pwsh
      run: |
        # Find Qt 6 installation
        $qtDir = "C:\Qt\6.6.3\mingw_64"
        if (Test-Path $qtDir) {
          echo "Qt 6.6.3 MinGW found at $qtDir"
          echo "QTDIR=$qtDir" | Out-File -FilePath $env:GITHUB_ENV -Encoding utf8 -Append
          echo "$qtDir\bin" | Out-File -FilePath $env:GITHUB_PATH -Encoding utf8 -Append
        } else {
          Write-Error "Qt 6.6.3 not found!"
          exit 1
        }

    - name: Configure CMake
      run: |
        mkdir build
        cd build
        cmake .. -G "MinGW Makefiles"

    - name: Build
      run: |
        cd build
        mingw32-make
